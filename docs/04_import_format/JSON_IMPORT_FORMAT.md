# Kioku JSON Import Format Specification

**Version**: 1.0
**Last Updated**: 2025-10-22
**Purpose**: Guide for converting raw journal data to Kioku-compatible JSON format

---

## Overview

This document describes the JSON format that Kioku accepts for importing journal entries. Use this specification to convert raw journal data (Markdown, plain text, etc.) into a structured JSON file that can be imported into Kioku.

**Key Points**:
- Only `entries` array is **required** for basic import
- Other fields (`entities`, `relationships`, `insights`, `conversations`) are **optional** and will be generated by Kioku's AI
- Entries can be plain text (unencrypted) for import
- Dates must be in ISO 8601 format
- Minimal import: Just entries with `date` and `content`

---

## Minimal Import Format

For converting raw journal entries, you only need:

```json
{
  "version": "1.0",
  "entries": [
    {
      "date": "2025-10-21T00:00:00Z",
      "content": "Your journal entry text here..."
    }
  ]
}
```

That's it! Kioku will:
- ✅ Generate UUIDs automatically
- ✅ Extract entities via AI
- ✅ Discover relationships via AI
- ✅ Generate insights via AI
- ✅ Set timestamps automatically

---

## Complete JSON Structure

### Top-Level Fields

```json
{
  "version": "1.0",                    // Required: Format version
  "exported_at": "2025-10-22T13:05:39Z",  // Optional: Export timestamp
  "export_metadata": { ... },          // Optional: Metadata
  "entries": [ ... ],                  // Required: Journal entries
  "entities": [ ... ],                 // Optional: Extracted entities
  "relationships": [ ... ],            // Optional: Entity relationships
  "insights": [ ... ],                 // Optional: AI insights
  "conversations": [ ... ]             // Optional: Chat history
}
```

---

## Entry Object Specification

### Minimal Entry (Required Fields Only)

```json
{
  "date": "2025-10-21T00:00:00Z",    // Required: ISO 8601 date
  "content": "Entry text..."          // Required: Entry content (plain text OK)
}
```

### Complete Entry (All Fields)

```json
{
  "id": "16FB979A-D2D0-425A-90AB-9A0C2D2C3B18",  // Optional: UUID (auto-generated if missing)
  "date": "2025-10-21T00:00:00Z",                // Required: Entry date (ISO 8601)
  "content": "Your journal entry content...",     // Required: Plain text or encrypted
  "is_encrypted": false,                          // Optional: Encryption flag (default: false)
  "data_version": 2,                              // Optional: Schema version (default: 2)
  "created_at": "2025-10-21T10:00:00Z",          // Optional: Creation timestamp (auto-generated)
  "updated_at": "2025-10-21T10:00:00Z",          // Optional: Update timestamp (auto-generated)
  "entity_ids": [],                               // Optional: Linked entity UUIDs (auto-populated by AI)
  "relationship_ids": [],                         // Optional: Linked relationship UUIDs (auto-populated)
  "analysis_ids": [],                             // Optional: Linked analysis UUIDs
  "kg_tracking": {                                // Optional: Knowledge graph metadata (auto-generated)
    "is_entities_extracted": false,
    "is_relationships_discovered": false,
    "entities_extracted_at": null,
    "entities_extraction_model": null,
    "relationships_discovered_at": null,
    "relationships_discovery_model": null
  }
}
```

### Field Descriptions

| Field | Required | Type | Description |
|-------|----------|------|-------------|
| `date` | ✅ Yes | ISO 8601 string | Entry date. Must be in format: `YYYY-MM-DDTHH:MM:SSZ` |
| `content` | ✅ Yes | String | Entry text. Plain text is fine for import (no encryption needed) |
| `id` | ❌ No | UUID string | Unique identifier. Auto-generated if not provided |
| `is_encrypted` | ❌ No | Boolean | Set to `false` for plain text imports (default) |
| `created_at` | ❌ No | ISO 8601 string | Creation timestamp. Auto-set to import time if missing |
| `updated_at` | ❌ No | ISO 8601 string | Last modified timestamp. Auto-set if missing |
| `entity_ids` | ❌ No | Array of UUIDs | Leave empty `[]` - AI will extract entities after import |
| `relationship_ids` | ❌ No | Array of UUIDs | Leave empty `[]` - AI will discover relationships |
| `kg_tracking` | ❌ No | Object | Leave out - Kioku tracks AI extraction automatically |

---

## Date Format Guidelines

**Important**: All dates must be in ISO 8601 format with UTC timezone.

### Format Examples

```json
"date": "2025-10-21T00:00:00Z"      // ✅ Correct: Full ISO 8601 with time
"date": "2025-10-21T17:00:00Z"      // ✅ Correct: With specific time
"date": "2025-10-21"                // ❌ Wrong: Missing time and timezone
"date": "21/10/2025"                // ❌ Wrong: Not ISO 8601 format
```

### Converting Common Date Formats

| Input Format | Conversion | ISO 8601 Output |
|--------------|------------|-----------------|
| `10.21` (MM.DD) | Add current year + midnight UTC | `2025-10-21T00:00:00Z` |
| `2025-10-21` | Add midnight UTC | `2025-10-21T00:00:00Z` |
| `21/10/2025` | Reformat + add midnight UTC | `2025-10-21T00:00:00Z` |
| `Oct 21, 2025` | Parse + add midnight UTC | `2025-10-21T00:00:00Z` |

### Time Offset Note

**Vietnamese Timezone (GMT+7)**: If your entries are in Vietnam time:
- Vietnam: `2025-10-21 08:00 AM (GMT+7)`
- Convert to UTC: `2025-10-21T01:00:00Z` (subtract 7 hours)

**For daily entries without specific times**, use midnight UTC:
- `2025-10-21T00:00:00Z` is fine for entry dated "October 21"

---

## Optional Fields (Auto-Generated by AI)

You **do not need** to include these when importing raw journal entries. Kioku will generate them automatically:

### Entities (Optional)

```json
"entities": [
  {
    "id": "DC351039-8E84-4DD6-ABAC-6D4DC3A48AEB",
    "value": "mẹ",
    "type": "people",
    "confidence": 0.9,
    "entry_ids": ["16FB979A-..."],
    "aliases": [],
    "conversation_ids": [],
    "created_at": "2025-10-22T13:05:39Z",
    "updated_at": "2025-10-22T13:05:39Z"
  }
]
```

**Entity Types**: `people`, `places`, `topics`, `events`, `emotions`, `organizations`, `things`

### Relationships (Optional)

```json
"relationships": [
  {
    "id": "EC35A4BE-D92E-447E-B3DF-E2E67846478C",
    "from_entity_id": "...",
    "to_entity_id": "...",
    "type": "emotional",
    "confidence": 0.85,
    "evidence": "Con không lo. Con sợ.",
    "source_entry_id": "...",
    "created_at": "2025-10-22T13:05:39Z"
  }
]
```

**Relationship Types**: `topical`, `emotional`, `temporal`, `causal`, `locational`

### Insights (Optional)

```json
"insights": [
  {
    "id": "CDC45110-E4F4-4E0D-93D8-D1A315573246",
    "title": "Emotional Pattern: Grief Process",
    "description": "Entries show progression through grief stages...",
    "type": "emotional",
    "timeframe": "weekly",
    "confidence": 0.82,
    "evidence": "{\"pattern\":\"grief_stages\"}",
    "related_entry_ids": ["..."],
    "related_entity_ids": [],
    "generated_at": "2025-10-22T13:05:39Z",
    "is_read": false,
    "is_starred": false
  }
]
```

### Conversations (Optional)

```json
"conversations": [
  {
    "id": "8A710351-8FF4-42FD-9871-1D75F2769734",
    "title": "Chat for 21 Oct 2025",
    "associated_date": "2025-10-21T00:00:00Z",
    "model_identifier": "openai/gpt-4o-mini",
    "has_knowledge_graph": false,
    "entity_ids": [],
    "context_note_ids": [],
    "messages": [],
    "created_at": "2025-10-22T13:05:39Z",
    "updated_at": "2025-10-22T13:05:39Z"
  }
]
```

---

## Example Conversion

### Input: Raw Journal (Markdown)

```markdown
10.21
Quay lại nhịp độ bình thường.

10.20
Đi làm lại.
Ào ào để quên chuyện mẹ.
Chả quên được.
Chiều đi in ảnh mẹ, về nhà cúng mẹ với Phong Vỵ.
Bình yên.
```

### Output: Kioku JSON

```json
{
  "version": "1.0",
  "entries": [
    {
      "date": "2025-10-21T00:00:00Z",
      "content": "Quay lại nhịp độ bình thường."
    },
    {
      "date": "2025-10-20T00:00:00Z",
      "content": "Đi làm lại.\nÀo ào để quên chuyện mẹ.\nChả quên được.\nChiều đi in ảnh mẹ, về nhà cúng mẹ với Phong Vỵ.\nBình yên."
    }
  ]
}
```

**That's it!** Just two fields per entry: `date` and `content`.

---

## Import Workflow

### Step 1: Convert Raw Data to JSON

Using AI (ChatGPT, Claude, etc.) with this prompt:

```
Convert the following raw journal entries to Kioku JSON format.
Follow the specification at: [link to this document]

Use ONLY these two fields per entry:
- date: Convert to ISO 8601 format (YYYY-MM-DDTHH:MM:SSZ)
- content: The entry text (preserve newlines with \n)

Raw data:
[paste your raw journal entries]
```

### Step 2: Validate JSON

Check that:
- ✅ Valid JSON syntax
- ✅ All dates in ISO 8601 format
- ✅ Content is plain text (not encrypted)

### Step 3: Import to Kioku

1. Open Kioku app
2. Go to **Settings** → **Data Management**
3. Tap **"Import from JSON"**
4. Select your converted JSON file
5. Wait for import to complete

### Step 4: Trigger AI Processing (Optional)

After import:
1. Go to **Settings** → **Knowledge Graph**
2. Tap **"Extract Entities & Relationships"**
3. AI will process all imported entries

---

## Export Metadata (Optional)

For complete exports (not needed for basic imports):

```json
"export_metadata": {
  "app_version": "1.0.0",
  "data_version": 2,
  "encryption_enabled": false,
  "entry_count": 11,
  "entity_count": 0,
  "relationship_count": 0,
  "insight_count": 0,
  "conversation_count": 0
}
```

---

## Conflict Resolution

When importing, Kioku offers conflict strategies:

1. **Skip Duplicates** (default): Ignore entries with existing ID or same date+content
2. **Merge**: Update existing entries with newer data
3. **Replace**: Overwrite existing entries completely

**Recommendation**: Use **Skip Duplicates** for first import, **Merge** for updates.

---

## Common Pitfalls

### ❌ Wrong Date Format

```json
"date": "10.21"           // Wrong: Not ISO 8601
"date": "2025-10-21"      // Wrong: Missing time and timezone
```

✅ **Correct**:
```json
"date": "2025-10-21T00:00:00Z"
```

### ❌ Missing Required Fields

```json
{
  "content": "Entry text..."  // Wrong: Missing date
}
```

✅ **Correct**:
```json
{
  "date": "2025-10-21T00:00:00Z",
  "content": "Entry text..."
}
```

### ❌ Encrypted Content Without Key

```json
{
  "content": "zBQlLw16o/cwCzC3...",
  "is_encrypted": true  // Wrong: Can't import encrypted without encryption key
}
```

✅ **Correct** (for imports):
```json
{
  "content": "Plain text entry...",
  "is_encrypted": false
}
```

---

## AI Conversion Prompt Template

Use this prompt with AI tools (ChatGPT, Claude, etc.) to convert your raw data:

```
You are a data conversion assistant. Convert the following journal entries to Kioku JSON format.

RULES:
1. Use ONLY two fields per entry: "date" and "content"
2. Convert dates to ISO 8601 format: YYYY-MM-DDTHH:MM:SSZ
3. For MM.DD format, assume year 2025 and add T00:00:00Z
4. Preserve all text exactly as written (including Vietnamese)
5. Use \n for line breaks within content
6. Output valid JSON only, no explanations

FORMAT:
{
  "version": "1.0",
  "entries": [
    {
      "date": "YYYY-MM-DDTHH:MM:SSZ",
      "content": "Entry text here..."
    }
  ]
}

RAW JOURNAL DATA:
[Paste your raw journal entries here]
```

---

## Testing Your JSON

Before importing:

1. **Validate JSON syntax**: Use [jsonlint.com](https://jsonlint.com)
2. **Check date format**: All dates must end with `Z`
3. **Verify content**: Text should be readable (not encrypted)
4. **Test small batch first**: Import 2-3 entries to verify format

---

## Support & Questions

- **Import Issues**: Check console logs in Xcode for error messages
- **Date Format Help**: Use ISO 8601 converter tools online
- **AI Extraction**: Entities/relationships auto-extract after import (may take a few minutes)

---

## Version History

- **1.0** (2025-10-22): Initial specification
  - Minimal format: date + content only
  - Optional: entities, relationships, insights, conversations
  - Encryption support
  - Conflict resolution strategies
